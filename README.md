# 点云代码学习
此文档用于记录点云代码学习笔记

点云处理简要流程：采集 → 清洗预处理 → 添加噪声/增强 → 特征提取 → 输入模型训练 → 后处理 → 评估 → 可视化


## 目录
 - 文件功能说明
 - 文件结构说明
 - 处理流程/逻辑展示



 
## 文件功能说明  
 **1. data-prepare文件夹:**  
 （1）step0_read_las.py  
 （2）step1_data_prepare_H3D.py  
 （3）step1_data_prepare_V3D.py  
 （4）step2_data_process_randla.py  
 （5）help_tool.py  
 （6）help_ply.py
 
 - step0_read_las.py：  
 输入：原始.las 格式点云数据（含空间坐标、颜色、分类标签等）   
 输出：内存中的numpy数组（x,y,z,RGB,label）、min_xyz起始坐标（后续可用于还原位置信息）  
数据状态：原始格式转换为标准数组  
 处理：  
    - a）解析.las文件结构      
    - b）提取xyz坐标（归一化到起点）、RGB颜色、标签（classification）

 - step1_data_prepare_H3D.py / step1_data_prepare_V3D.py：  
 两文件的区别：  
 H3D.py 处理的是 H3D 格式的点云数据（含 RGB、instance、label、可能还带 intensity）  
 V3D.py 针对的是 V3D 格式的点云数据（结构简洁，可能只有 XYZ 和 label）  
 输入：step0产出的数组数据  
 输出：.ply格式的点云文件、KD-Tree或其他中间结构缓存（如 .npy/.pkl 文件）  
 数据状态：已变为可视化或深度学习框架可读格式  
 操作：  
    - a）构建KD-Tree空间结构  
    - b）写出.ply文件：XYZ+RGB+Label  

 - step2_data_process_randla.py:  
 输入：.ply格式的点云文件  
 输出：是保存在output_dir目录下的两个文件，一个是处理后的点云特征数据文件，另一个是标签文件。  
 a）处理后的特征数据文件(同名.txt文件),把原数据中除了最后一列(label)以外的列都提取出来，在第4列插入值0，用于之后的模型输入、特征工程、数据增强等。  
 b）标签文件(同名.label文件),只保存每一个点的标签（最后一列0,通常用于分类监督学习模型的目标值。  
 数据状态：结构化、标准化、块化后的训练输入数据。  
 操作：  
    - a）对每个点云文件提取标签（最后一列）。  
    - b）修改点云特征（在每行的第四列插入0）。  
    - c）将处理后的数据和标签分别保存到输出目录中。


 **2. Noise_DataAugmentation**  
 （1）txt_guassian_noise.py  
 （2）txt_guassian_noise_limited.py


 - txt_guassian_noise.py：  
 输入：.txt 格式的点云特征数据文件（通常由 step2_data_process_randla.py 输出产生）  
 输出：  
 在指定输出目录中生成新文件：文件名为原文件名加后缀 _gauss5%.txt  
 数据包含原始点云 + 5% 高斯噪声点  
 总结构为：x，y，z，r，g，b，label。原始点label保留，噪声点标签为1）    
 数据状态：  
 1）原始点云 + 结构相关的噪声点  
 2）噪声点按点云平均尺度（均值半径）和标准差添加  
 操作：  
   - a）读取原始 .txt 点云数据  
   - b）统计其三维空间中心及点云扩展尺度（均值和标准差）  
   - c）按 5% 数量，得出要添加的噪声点的数量，并为每个噪声点添加高斯噪声  
   - d）为每个噪声点复制原颜色信息，并将标签置为 1，表示添加了高斯噪声  
   - e）将原始数据和新噪声点合并，保存为新 .txt 文件（同目录、不同后缀）




 - txt_guassian_noise_limited.py：  
 输入：与 txt_guassian_noise.py的输入相同。   
 输出：  
 在指定输出目录中生成新文件：文件名为原文件名加后缀 _gauss5%_0.1m.txt  
 数据包含原始点云 + 加入的高斯噪声点  
 所有噪声点坐标被限制在原点云的XYZ范围内  
 数据状态：  
 原始点云 + 控制在空间边界内的噪声点（以 noise_limit=0.1m 为最大扰动）  
 模拟设备稳定性较高的干扰或环境中微小扰动  
 操作：  
   - a）读取原始 .txt 点云数据  
   - b）统计其XYZ轴的最小值与最大值  
   - c）按5%比例采样原始点，因为要加入原点数5%的噪声点，对固定数量采样出来的原始点加入均值为0、标准差为0.1的高斯扰动  
   - d）对扰动后坐标做边界裁剪，确保不超过原始点云边界  
   - e）为每个噪声点复制原颜色信息，并将标签置为 1  
   - f）将原始数据与新噪声点合并并保存为新 .txt 文件

 txt_guassian_noise_limited.py与txt_guassian_noise.py的区别：  
   - txt_guassian_noise.py：  
   1）噪声幅度：根据点云整体尺度（平均半径）自动计算。  
   2）噪声位置限制：不限制坐标范围，可能超出原始点云边界。  
   3）噪声方向：随机单位向量方向 + 距离扰动（结构敏感）。  
   4）标签：添加的点统一为 1。  
   5）控制程度：更随机、更依赖点云形态。  
   - txt_guassian_noise_limited.py：  
   1）噪声幅度：固定噪声强度，使用 noise_limit 参数控制（如 0.1m）。  
   2）噪声位置限制：限制噪声点坐标在 XYZ 最大/最小值之间。  
   3）噪声方向：随机方向（各轴独立），无结构考虑。  
   4）标签：相同，统一为 1。  
   5）控制程度：更可控、更适用于封闭环境。  



 ## 文件结构说明  


 ## 处理流程/逻辑展示
 
